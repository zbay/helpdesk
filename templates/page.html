<!doctype html>
<link rel="alternate" type="application/json" href="archivedPages.json">
<title>Archiving Rule</title>
<style>
    #tagField{
        width:90%;
    }
</style>
<body>
<h1 class="page_id">Page ID: {{ page['@id'][5:] }}</h1>
<div style="background-color:lightgray; padding:5px;">
<h2 class="func_des">Edit page description and tags:</h2>
<form class="metadata-changer" method="patch">
	<span itemscope itemtype="http://schema.org/WebPage">
            <label class="url">URL: <a itemprop="url" href="{{ page['url'] }}">{{ page['url'] }}</a></label><br />
            <label class="date">Date: {{ page['date'] }}</label><br />
            <label class="rule">Associated rule: <a href="../rule/{{ page['ruleID'] }}">{{ page['ruleID'] }}</a></label><br />
			<label class="tag_collection">Current tags:
                <ul>
                {% for counter in range (0, (page['tags']|length)) %}
                    <li class="tag">
                    {{page['tags'][counter].strip()}}{% endfor %}
                    </li>
                </ul></label>
            <label>Add tags (separate with semicolons): <textarea name="tags"></textarea></label><br />
			<label>Description: <textarea itemprop="description" name="description">{{ page['description'] }}</textarea></label>
			<div><input class="update" type="submit" value="Save changes" id="rule-confirm"/></div></span></form>
             <script>
    var form = document.querySelector('form.metadata-changer');
    var button = document.querySelector('form.metadata-changer input.update');
    button.addEventListener('click', function (event) {
      event.preventDefault();
      var request = new XMLHttpRequest();
      request.open('PATCH', window.location.pathname);
      request.onreadystatechange = function () {
        if (XMLHttpRequest.DONE === request.readyState
            && 200 === request.status) {
          window.location.reload(true);
        }
      }
      request.send(new FormData(form));
    }, false);
  </script>
        </div>
<a href="../pages" rel="collection">View all pages.</a>
</body>
</html>
